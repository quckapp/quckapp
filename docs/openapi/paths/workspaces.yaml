# Workspaces API Paths

workspaces:
  get:
    tags:
      - Workspaces
    summary: List user's workspaces
    description: Get all workspaces the current user is a member of
    operationId: listWorkspaces
    security:
      - bearerAuth: []
    responses:
      '200':
        description: List of workspaces
        content:
          application/json:
            schema:
              type: object
              properties:
                workspaces:
                  type: array
                  items:
                    $ref: '../schemas/workspace.yaml#/Workspace'

  post:
    tags:
      - Workspaces
    summary: Create workspace
    description: Create a new workspace
    operationId: createWorkspace
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/workspace.yaml#/WorkspaceCreateRequest'
    responses:
      '201':
        description: Workspace created
        content:
          application/json:
            schema:
              $ref: '../schemas/workspace.yaml#/Workspace'
      '400':
        description: Invalid input
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/ValidationError'
      '409':
        description: Slug already taken
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

workspace-by-id:
  get:
    tags:
      - Workspaces
    summary: Get workspace
    description: Get workspace details by ID
    operationId: getWorkspace
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Workspace details
        content:
          application/json:
            schema:
              $ref: '../schemas/workspace.yaml#/Workspace'
      '403':
        description: Not a member of workspace
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'
      '404':
        description: Workspace not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

  patch:
    tags:
      - Workspaces
    summary: Update workspace
    description: Update workspace details (admin only)
    operationId: updateWorkspace
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/workspace.yaml#/WorkspaceUpdateRequest'
    responses:
      '200':
        description: Workspace updated
        content:
          application/json:
            schema:
              $ref: '../schemas/workspace.yaml#/Workspace'
      '403':
        description: Not authorized
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

  delete:
    tags:
      - Workspaces
    summary: Delete workspace
    description: Delete workspace (owner only)
    operationId: deleteWorkspace
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - confirmation
            properties:
              confirmation:
                type: string
                description: Workspace name for confirmation
    responses:
      '204':
        description: Workspace deleted
      '403':
        description: Not the workspace owner
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

workspace-by-slug:
  get:
    tags:
      - Workspaces
    summary: Get workspace by slug
    description: Get workspace details by URL slug
    operationId: getWorkspaceBySlug
    security:
      - bearerAuth: []
    parameters:
      - name: slug
        in: path
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Workspace details
        content:
          application/json:
            schema:
              $ref: '../schemas/workspace.yaml#/Workspace'
      '404':
        description: Workspace not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

workspace-members:
  get:
    tags:
      - Workspaces
      - Members
    summary: List workspace members
    description: Get all members of a workspace
    operationId: listWorkspaceMembers
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: role
        in: query
        schema:
          type: string
          enum: [member, admin, owner, guest]
      - name: search
        in: query
        schema:
          type: string
        description: Search by name or email
      - $ref: '../schemas/common.yaml#/PageParam'
      - $ref: '../schemas/common.yaml#/LimitParam'
    responses:
      '200':
        description: List of members
        content:
          application/json:
            schema:
              type: object
              properties:
                members:
                  type: array
                  items:
                    $ref: '../schemas/workspace.yaml#/WorkspaceMember'
                pagination:
                  $ref: '../schemas/common.yaml#/Pagination'

workspace-member-by-id:
  get:
    tags:
      - Workspaces
      - Members
    summary: Get workspace member
    description: Get details of a specific workspace member
    operationId: getWorkspaceMember
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: userId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Member details
        content:
          application/json:
            schema:
              $ref: '../schemas/workspace.yaml#/WorkspaceMember'
      '404':
        description: Member not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

  patch:
    tags:
      - Workspaces
      - Members
    summary: Update member role
    description: Update a member's role in the workspace (admin only)
    operationId: updateWorkspaceMember
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: userId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              role:
                type: string
                enum: [member, admin, guest]
              title:
                type: string
    responses:
      '200':
        description: Member updated
        content:
          application/json:
            schema:
              $ref: '../schemas/workspace.yaml#/WorkspaceMember'
      '403':
        description: Not authorized
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

  delete:
    tags:
      - Workspaces
      - Members
    summary: Remove member
    description: Remove a member from the workspace (admin only)
    operationId: removeWorkspaceMember
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: userId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '204':
        description: Member removed
      '403':
        description: Not authorized
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

workspace-leave:
  post:
    tags:
      - Workspaces
    summary: Leave workspace
    description: Leave the workspace (cannot be owner)
    operationId: leaveWorkspace
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '204':
        description: Left workspace
      '400':
        description: Cannot leave (owner must transfer ownership first)
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

workspace-invites:
  get:
    tags:
      - Workspaces
      - Invites
    summary: List pending invites
    description: Get all pending invites for a workspace (admin only)
    operationId: listWorkspaceInvites
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: status
        in: query
        schema:
          type: string
          enum: [pending, accepted, expired, revoked]
      - $ref: '../schemas/common.yaml#/PageParam'
      - $ref: '../schemas/common.yaml#/LimitParam'
    responses:
      '200':
        description: List of invites
        content:
          application/json:
            schema:
              type: object
              properties:
                invites:
                  type: array
                  items:
                    $ref: '../schemas/workspace.yaml#/WorkspaceInvite'
                pagination:
                  $ref: '../schemas/common.yaml#/Pagination'

  post:
    tags:
      - Workspaces
      - Invites
    summary: Invite members
    description: Send workspace invitations by email (admin only)
    operationId: inviteMembers
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/workspace.yaml#/InviteMembersRequest'
    responses:
      '200':
        description: Invites sent
        content:
          application/json:
            schema:
              type: object
              properties:
                sent:
                  type: integer
                failed:
                  type: array
                  items:
                    type: object
                    properties:
                      email:
                        type: string
                      reason:
                        type: string

workspace-invite-revoke:
  delete:
    tags:
      - Workspaces
      - Invites
    summary: Revoke invite
    description: Revoke a pending invite
    operationId: revokeInvite
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: inviteId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '204':
        description: Invite revoked
      '404':
        description: Invite not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

workspace-invite-accept:
  post:
    tags:
      - Workspaces
      - Invites
    summary: Accept invite
    description: Accept a workspace invitation
    operationId: acceptInvite
    security:
      - bearerAuth: []
    parameters:
      - name: inviteCode
        in: path
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Invite accepted
        content:
          application/json:
            schema:
              $ref: '../schemas/workspace.yaml#/Workspace'
      '400':
        description: Invalid or expired invite
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'
      '409':
        description: Already a member
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

workspace-stats:
  get:
    tags:
      - Workspaces
    summary: Get workspace stats
    description: Get workspace statistics
    operationId: getWorkspaceStats
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Workspace statistics
        content:
          application/json:
            schema:
              $ref: '../schemas/workspace.yaml#/WorkspaceStats'

workspace-icon:
  put:
    tags:
      - Workspaces
    summary: Upload workspace icon
    description: Upload a new workspace icon (admin only)
    operationId: uploadWorkspaceIcon
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            required:
              - icon
            properties:
              icon:
                type: string
                format: binary
    responses:
      '200':
        description: Icon uploaded
        content:
          application/json:
            schema:
              type: object
              properties:
                iconUrl:
                  type: string
                  format: uri

  delete:
    tags:
      - Workspaces
    summary: Remove workspace icon
    description: Remove workspace icon (admin only)
    operationId: removeWorkspaceIcon
    security:
      - bearerAuth: []
    parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '204':
        description: Icon removed
