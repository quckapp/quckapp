# Docker Compose for Swagger UI
# Run: docker-compose -f docs/openapi/docker-compose.yaml up

version: '3.8'

services:
  swagger-ui:
    image: swaggerapi/swagger-ui:v5.10.3
    container_name: quikapp-swagger-ui
    ports:
      - "8080:8080"
    environment:
      - SWAGGER_JSON=/openapi/openapi.yaml
      - BASE_URL=/docs
      - DEEP_LINKING=true
      - DISPLAY_REQUEST_DURATION=true
      - FILTER=true
      - SHOW_EXTENSIONS=true
      - SHOW_COMMON_EXTENSIONS=true
      - TRY_IT_OUT_ENABLED=true
      - PERSIST_AUTHORIZATION=true
      - VALIDATOR_URL=null
      - DOC_EXPANSION=list
      - DEFAULT_MODELS_EXPAND_DEPTH=1
      - DEFAULT_MODEL_EXPAND_DEPTH=2
      - SYNTAX_HIGHLIGHT_ACTIVATE=true
      - SYNTAX_HIGHLIGHT_THEME=monokai
    volumes:
      - ./:/openapi:ro
    networks:
      - quikapp-docs
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:8080/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  # Redoc alternative documentation UI
  redoc:
    image: redocly/redoc:v2.1.3
    container_name: quikapp-redoc
    ports:
      - "8081:80"
    environment:
      - SPEC_URL=/openapi/openapi.yaml
      - REDOC_OPTIONS=hideDownloadButton=false hideHostname=false
    volumes:
      - ./:/usr/share/nginx/html/openapi:ro
    networks:
      - quikapp-docs

  # Mock server for API testing
  prism:
    image: stoplight/prism:5
    container_name: quikapp-mock-server
    command: mock -h 0.0.0.0 /openapi/openapi.yaml
    ports:
      - "4010:4010"
    volumes:
      - ./:/openapi:ro
    networks:
      - quikapp-docs

networks:
  quikapp-docs:
    driver: bridge
