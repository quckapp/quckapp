# Authentication Schema Definitions

LoginRequest:
  type: object
  required:
    - email
    - password
  properties:
    email:
      type: string
      format: email
      description: User email address
      example: "user@example.com"
    password:
      type: string
      format: password
      minLength: 8
      description: User password
      example: "securePassword123"
    mfaCode:
      type: string
      pattern: "^[0-9]{6}$"
      description: MFA code if enabled
      example: "123456"
    rememberMe:
      type: boolean
      description: Extend session duration
      default: false

LoginResponse:
  type: object
  required:
    - user
    - tokens
  properties:
    user:
      $ref: './user.yaml#/User'
    tokens:
      $ref: '#/TokenPair'
    requiresMfa:
      type: boolean
      description: Whether MFA verification is required
      default: false
    mfaMethods:
      type: array
      items:
        type: string
        enum: [totp, sms, email]
      description: Available MFA methods

TokenPair:
  type: object
  required:
    - accessToken
    - refreshToken
    - expiresIn
  properties:
    accessToken:
      type: string
      description: JWT access token
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    refreshToken:
      type: string
      description: Refresh token for obtaining new access tokens
      example: "dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4..."
    expiresIn:
      type: integer
      description: Access token expiration time in seconds
      example: 3600
    tokenType:
      type: string
      description: Token type
      default: "Bearer"
      example: "Bearer"

RefreshTokenRequest:
  type: object
  required:
    - refreshToken
  properties:
    refreshToken:
      type: string
      description: The refresh token
      example: "dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4..."

RegisterRequest:
  type: object
  required:
    - email
    - password
    - name
  properties:
    email:
      type: string
      format: email
      example: "newuser@example.com"
    password:
      type: string
      format: password
      minLength: 8
      description: "Must contain uppercase, lowercase, number, and special character"
      example: "SecurePass123!"
    name:
      type: string
      minLength: 2
      maxLength: 100
      example: "John Doe"
    inviteCode:
      type: string
      description: Workspace invite code
      example: "INV-ABC123"

PasswordResetRequest:
  type: object
  required:
    - email
  properties:
    email:
      type: string
      format: email
      example: "user@example.com"

PasswordResetConfirm:
  type: object
  required:
    - token
    - password
  properties:
    token:
      type: string
      description: Password reset token from email
      example: "reset_token_abc123"
    password:
      type: string
      format: password
      minLength: 8
      example: "NewSecurePass123!"

OAuthRequest:
  type: object
  required:
    - provider
    - code
  properties:
    provider:
      type: string
      enum: [google, github, microsoft, apple]
      description: OAuth provider
      example: "google"
    code:
      type: string
      description: Authorization code from OAuth provider
      example: "4/P7q7W91..."
    redirectUri:
      type: string
      format: uri
      description: Redirect URI used in authorization request
      example: "https://app.quikapp.io/auth/callback"

MfaSetupResponse:
  type: object
  properties:
    secret:
      type: string
      description: TOTP secret for authenticator apps
      example: "JBSWY3DPEHPK3PXP"
    qrCode:
      type: string
      format: uri
      description: QR code image URL
      example: "data:image/png;base64,..."
    backupCodes:
      type: array
      items:
        type: string
      description: Backup codes for account recovery
      example: ["ABC123", "DEF456", "GHI789"]

MfaVerifyRequest:
  type: object
  required:
    - code
  properties:
    code:
      type: string
      pattern: "^[0-9]{6}$"
      description: 6-digit MFA code
      example: "123456"
    trustDevice:
      type: boolean
      description: Remember this device
      default: false

Session:
  type: object
  properties:
    id:
      type: string
      format: uuid
      example: "550e8400-e29b-41d4-a716-446655440000"
    userId:
      type: string
      format: uuid
    device:
      type: string
      description: Device description
      example: "Chrome on macOS"
    ip:
      type: string
      description: IP address
      example: "192.168.1.1"
    location:
      type: string
      description: Approximate location
      example: "San Francisco, CA"
    lastActive:
      type: string
      format: date-time
      example: "2024-01-15T10:30:00Z"
    current:
      type: boolean
      description: Whether this is the current session
      example: true
