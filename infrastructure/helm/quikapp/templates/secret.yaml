{{/*
Secret for QuikApp sensitive configuration
Note: In production, use external secret management (Vault, AWS Secrets Manager, etc.)
*/}}
apiVersion: v1
kind: Secret
metadata:
  name: quikapp-secrets
  namespace: {{ .Values.global.namespace | default .Release.Namespace }}
  labels:
    {{- include "quikapp.labels" . | nindent 4 }}
  annotations:
    description: "QuikApp secrets - Replace with external secret management in production"
type: Opaque
stringData:
  # JWT Configuration
  JWT_SECRET: "REPLACE_WITH_SECURE_SECRET"
  JWT_REFRESH_SECRET: "REPLACE_WITH_SECURE_REFRESH_SECRET"

  # Database Credentials
  MYSQL_ROOT_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"
  MYSQL_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"

  POSTGRES_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"

  MONGODB_ROOT_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"
  MONGODB_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"

  # Redis
  REDIS_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"

  # Elasticsearch
  ELASTICSEARCH_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"

  # MinIO / S3
  MINIO_ACCESS_KEY: "REPLACE_WITH_ACCESS_KEY"
  MINIO_SECRET_KEY: "REPLACE_WITH_SECRET_KEY"

  # Kafka
  KAFKA_SASL_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"

  # OAuth / Social Login
  GOOGLE_CLIENT_ID: "REPLACE_WITH_CLIENT_ID"
  GOOGLE_CLIENT_SECRET: "REPLACE_WITH_CLIENT_SECRET"

  GITHUB_CLIENT_ID: "REPLACE_WITH_CLIENT_ID"
  GITHUB_CLIENT_SECRET: "REPLACE_WITH_CLIENT_SECRET"

  # Email Service
  SMTP_USERNAME: "REPLACE_WITH_USERNAME"
  SMTP_PASSWORD: "REPLACE_WITH_PASSWORD"

  # Push Notifications
  FCM_SERVER_KEY: "REPLACE_WITH_FCM_KEY"
  APNS_KEY: "REPLACE_WITH_APNS_KEY"

  # Encryption Keys
  ENCRYPTION_KEY: "REPLACE_WITH_32_CHAR_KEY"
  ENCRYPTION_IV: "REPLACE_WITH_16_CHAR_IV"

  # API Keys for external services
  SENDGRID_API_KEY: "REPLACE_WITH_API_KEY"
  TWILIO_AUTH_TOKEN: "REPLACE_WITH_AUTH_TOKEN"
  STRIPE_SECRET_KEY: "REPLACE_WITH_SECRET_KEY"

---
{{/*
External Secrets example (for use with external-secrets operator)
Uncomment and configure if using external-secrets
*/}}
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: quikapp-external-secrets
#   namespace: {{ .Values.global.namespace | default .Release.Namespace }}
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     kind: ClusterSecretStore
#     name: vault-backend
#   target:
#     name: quikapp-secrets
#     creationPolicy: Owner
#   data:
#     - secretKey: JWT_SECRET
#       remoteRef:
#         key: secret/quikapp/jwt
#         property: secret
#     - secretKey: MYSQL_PASSWORD
#       remoteRef:
#         key: secret/quikapp/mysql
#         property: password
#     # Add more secrets as needed

---
{{/*
Image pull secret for private registries
*/}}
{{- if .Values.global.imagePullSecrets }}
{{- range .Values.global.imagePullSecrets }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ . }}
  namespace: {{ $.Values.global.namespace | default $.Release.Namespace }}
  labels:
    {{- include "quikapp.labels" $ | nindent 4 }}
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: {{ printf "{\"auths\":{\"REGISTRY_URL\":{\"auth\":\"BASE64_ENCODED_AUTH\"}}}" | b64enc | quote }}
{{- end }}
{{- end }}
