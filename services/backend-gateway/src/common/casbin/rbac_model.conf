# Request definition
# sub = subject (user), obj = object (resource), act = action, dom = domain (optional)
[request_definition]
r = sub, dom, obj, act

# Policy definition
# sub = subject, dom = domain, obj = object, act = action
[policy_definition]
p = sub, dom, obj, act, eft

# Role definition with domain support
# user -> role in domain
[role_definition]
g = _, _, _

# Policy effect - allow-override (deny takes precedence)
[policy_effect]
e = some(where (p.eft == allow)) && !some(where (p.eft == deny))

# Matchers
# Supports wildcards (*) and key matching for resource patterns
[matchers]
m = g(r.sub, p.sub, r.dom) && r.dom == p.dom && keyMatch2(r.obj, p.obj) && r.act == p.act || r.sub == "super_admin"
